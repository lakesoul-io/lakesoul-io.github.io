"use strict";(self.webpackChunklakesoul_website=self.webpackChunklakesoul_website||[]).push([[8938],{43:(e,l,s)=>{s.r(l),s.d(l,{assets:()=>r,contentTitle:()=>i,default:()=>c,frontMatter:()=>t,metadata:()=>o,toc:()=>u});var n=s(5893),a=s(1151);const t={},i="\u4f7f\u7528Kyuubi JDBC\u8bbf\u95eeLakesoul\u8868",o={id:"Usage Docs/setup-kyuubi",title:"\u4f7f\u7528Kyuubi JDBC\u8bbf\u95eeLakesoul\u8868",description:"\x3c!--",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/03-Usage Docs/13-setup-kyuubi.md",sourceDirName:"03-Usage Docs",slug:"/Usage Docs/setup-kyuubi",permalink:"/zh-Hans/docs/Usage Docs/setup-kyuubi",draft:!1,unlisted:!1,editUrl:"https://github.com/lakesoul-io/LakeSoul/tree/main/website/docs/03-Usage Docs/13-setup-kyuubi.md",tags:[],version:"current",sidebarPosition:13,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u591a\u79df\u6237\u529f\u80fd\uff1a\u5de5\u4f5c\u7a7a\u95f4\u548c\u89d2\u8272\u6743\u9650\u63a7\u5236",permalink:"/zh-Hans/docs/Usage Docs/workspace-and-rbac"},next:{title:"LakeSoul \u8868\u5b9e\u65f6\u51fa\u6e56\u4f7f\u7528\u624b\u518c",permalink:"/zh-Hans/docs/Usage Docs/export-to-databases"}},r={},u=[{value:"\u73af\u5883\u8981\u6c42",id:"\u73af\u5883\u8981\u6c42",level:2},{value:"Flink SQL\u8bbf\u95eeLakesoul\u8868",id:"flink-sql\u8bbf\u95eelakesoul\u8868",level:2},{value:"1. \u4f9d\u8d56",id:"1-\u4f9d\u8d56",level:3},{value:"2. Flink\u914d\u7f6e\u9879",id:"2-flink\u914d\u7f6e\u9879",level:3},{value:"3. \u64cd\u4f5cLakeSoul",id:"3-\u64cd\u4f5clakesoul",level:3},{value:"Spark SQL\u8bbf\u95eeLakesoul\u8868",id:"spark-sql\u8bbf\u95eelakesoul\u8868",level:2},{value:"1. \u4f9d\u8d56",id:"1-\u4f9d\u8d56-1",level:3},{value:"2. Spark\u914d\u7f6e\u9879",id:"2-spark\u914d\u7f6e\u9879",level:3},{value:"3. \u64cd\u4f5cLakeSoul",id:"3-\u64cd\u4f5clakesoul-1",level:3}];function d(e){const l={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.h1,{id:"\u4f7f\u7528kyuubi-jdbc\u8bbf\u95eelakesoul\u8868",children:"\u4f7f\u7528Kyuubi JDBC\u8bbf\u95eeLakesoul\u8868"}),"\n",(0,n.jsx)(l.admonition,{type:"tip",children:(0,n.jsx)(l.p,{children:"\u4ece 2.4 \u7248\u672c\u8d77\u63d0\u4f9b\u3002"})}),"\n",(0,n.jsx)(l.p,{children:"LakeSoul\u5b9e\u73b0\u4e86Flink/Spark Connector\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7Kyuubi\u4f7f\u7528Spark/Flink SQL\u6765\u67e5\u8be2\u8bbf\u95eeLakesoul."}),"\n",(0,n.jsx)(l.h2,{id:"\u73af\u5883\u8981\u6c42",children:"\u73af\u5883\u8981\u6c42"}),"\n",(0,n.jsxs)(l.table,{children:[(0,n.jsx)(l.thead,{children:(0,n.jsxs)(l.tr,{children:[(0,n.jsx)(l.th,{children:"\u7ec4\u4ef6"}),(0,n.jsx)(l.th,{children:"\u7248\u672c"})]})}),(0,n.jsxs)(l.tbody,{children:[(0,n.jsxs)(l.tr,{children:[(0,n.jsx)(l.td,{children:"Kyuubi"}),(0,n.jsx)(l.td,{children:"1.8"})]}),(0,n.jsxs)(l.tr,{children:[(0,n.jsx)(l.td,{children:"Spark"}),(0,n.jsx)(l.td,{children:"3.3"})]}),(0,n.jsxs)(l.tr,{children:[(0,n.jsx)(l.td,{children:"Flink"}),(0,n.jsx)(l.td,{children:"1.17"})]}),(0,n.jsxs)(l.tr,{children:[(0,n.jsx)(l.td,{children:"LakeSoul"}),(0,n.jsx)(l.td,{children:"2.5.2"})]}),(0,n.jsxs)(l.tr,{children:[(0,n.jsx)(l.td,{children:"Java"}),(0,n.jsx)(l.td,{children:"1.8"})]})]})]}),"\n",(0,n.jsx)(l.p,{children:"\u8fd0\u884c\u73af\u5883\u4e3aLinux\u73af\u5883\uff0c\u5e76\u5df2\u5b89\u88c5Spark, Flink, Kyuubi\uff0c\u63a8\u8350Kyuubi Engine\u4ee5Hadoop Yarn\u4f5c\u4e3a\u6267\u884c\u73af\u5883\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u672c\u5730\u542f\u52a8Spark/Flink Local\u96c6\u7fa4\u3002"}),"\n",(0,n.jsxs)(l.p,{children:["\u53ef\u53c2\u8003Kyuubi\u5b89\u88c5\u6587\u6863: ",(0,n.jsx)(l.a,{href:"https://kyuubi.readthedocs.io/en/v1.7.3/deployment/engine_on_yarn.html",children:"Deploy Kyuubi engines on Yarn"}),"."]}),"\n",(0,n.jsx)(l.h2,{id:"flink-sql\u8bbf\u95eelakesoul\u8868",children:"Flink SQL\u8bbf\u95eeLakesoul\u8868"}),"\n",(0,n.jsx)(l.h3,{id:"1-\u4f9d\u8d56",children:"1. \u4f9d\u8d56"}),"\n",(0,n.jsxs)(l.p,{children:["\u4e0b\u8f7dLakeSoul Flink Jar: ",(0,n.jsx)(l.a,{href:"https://github.com/lakesoul-io/LakeSoul/releases/download/v2.5.2/lakesoul-flink-flink-1.17-2.5.2.jar",children:"https://github.com/lakesoul-io/LakeSoul/releases/download/v2.5.2/lakesoul-flink-flink-1.17-2.5.2.jar"})]}),"\n",(0,n.jsxs)(l.p,{children:["\u5c06\u8be5jar\u62f7\u8d1d\u81f3 ",(0,n.jsx)(l.code,{children:"$FLINK_HOME/lib"}),"."]}),"\n",(0,n.jsx)(l.h3,{id:"2-flink\u914d\u7f6e\u9879",children:"2. Flink\u914d\u7f6e\u9879"}),"\n",(0,n.jsxs)(l.p,{children:["\u8bf7\u6839\u636e\u5982\u4e0b\u6587\u6863\u6765\u8bbe\u7f6e\u8fde\u63a5LakeSoul\u5143\u6570\u636e\u5e93\u9700\u8981\u7684PG\u53c2\u6570:\n",(0,n.jsx)(l.a,{href:"/zh-Hans/docs/Usage%20Docs/setup-spark#setup-metadata-database-connection-for-flink",children:"Setup Metadata Database Connection for Flink"})]}),"\n",(0,n.jsx)(l.p,{children:"\u5728\u6b64\u4e4b\u540e\uff0c\u60a8\u53ef\u4ee5\u50cf\u5f80\u5e38\u4e00\u6837\u542f\u52a8 Flink Session\u96c6\u7fa4\u6216Flink Application\u3002"}),"\n",(0,n.jsx)(l.h3,{id:"3-\u64cd\u4f5clakesoul",children:"3. \u64cd\u4f5cLakeSoul"}),"\n",(0,n.jsx)(l.p,{children:"\u4f7f\u7528Kyuubi beeline\u6765\u8fde\u63a5Flink SQL Engine:"}),"\n",(0,n.jsx)(l.pre,{children:(0,n.jsx)(l.code,{className:"language-bash",children:"$KYUUBI_HOME/bin/beeline -u 'jdbc:hive2://localhost:10009/default;user=admin;?kyuubi.engine.type=FLINK_SQL'\n"})}),"\n",(0,n.jsx)(l.p,{children:"\u4f7f\u7528Flink SQL\u64cd\u4f5cLakeSoul:"}),"\n",(0,n.jsx)(l.pre,{children:(0,n.jsx)(l.code,{className:"language-SQL",children:"create catalog lakesoul with('type'='lakesoul');\nuse catalog lakesoul;\nuse `default`;\n\ncreate table if not exists test_lakesoul_table_v1 (`id` INT, name STRING, score INT,`date` STRING,region STRING, PRIMARY KEY (`id`,`name`) NOT ENFORCED ) PARTITIONED BY (`region`,`date`) WITH ( 'connector'='lakeSoul', 'use_cdc'='true','format'='lakesoul', 'path'='hdfs:///lakesoul-test-bucket/default/test_lakesoul_table_v1/', 'hashBucketNum'='4');\n\ninsert into `lakesoul`.`default`.test_lakesoul_table_v1 values (1,'AAA', 100, '2023-05-11', 'China');\ninsert into `lakesoul`.`default`.test_lakesoul_table_v1 values (2,'BBB', 100, '2023-05-11', 'China');\ninsert into `lakesoul`.`default`.test_lakesoul_table_v1 values (3,'AAA', 98, '2023-05-10', 'China');\n\nselect * from `lakesoul`.`default`.test_lakesoul_table_v1 limit 1;\n\ndrop table `lakesoul`.`default`.test_lakesoul_table_v1;\n"})}),"\n",(0,n.jsxs)(l.p,{children:["\u53ef\u4ee5\u5c06\u6570\u636e\u5b58\u50a8\u8def\u5f84\u4e2d\u7684 ",(0,n.jsx)(l.code,{children:"hdfs://"})," \u66ff\u6362\u4e3a ",(0,n.jsx)(l.code,{children:"file://"})," \u3002"]}),"\n",(0,n.jsxs)(l.p,{children:["\u8be6\u7ec6\u7684Flink SQL\u64cd\u4f5cLakesoul\u5185\u5bb9\u53c2\u9605 : ",(0,n.jsx)(l.a,{href:"/zh-Hans/docs/Usage%20Docs/flink-lakesoul-connector",children:"Flink Lakesoul Connector"})]}),"\n",(0,n.jsx)(l.h2,{id:"spark-sql\u8bbf\u95eelakesoul\u8868",children:"Spark SQL\u8bbf\u95eeLakesoul\u8868"}),"\n",(0,n.jsx)(l.h3,{id:"1-\u4f9d\u8d56-1",children:"1. \u4f9d\u8d56"}),"\n",(0,n.jsxs)(l.p,{children:["\u4e0b\u8f7dLakeSoul Spark Jar: ",(0,n.jsx)(l.a,{href:"https://github.com/lakesoul-io/LakeSoul/releases/download/v2.5.2/lakesoul-spark-spark-3.3-2.5.2.jar",children:"https://github.com/lakesoul-io/LakeSoul/releases/download/v2.5.2/lakesoul-spark-spark-3.3-2.5.2.jar"})]}),"\n",(0,n.jsxs)(l.p,{children:["\u5c06\u8be5jar\u62f7\u8d1d\u81f3 ",(0,n.jsx)(l.code,{children:"$SPARK_HOME/jars"}),"."]}),"\n",(0,n.jsx)(l.h3,{id:"2-spark\u914d\u7f6e\u9879",children:"2. Spark\u914d\u7f6e\u9879"}),"\n",(0,n.jsxs)(l.ol,{children:["\n",(0,n.jsxs)(l.li,{children:["\n",(0,n.jsxs)(l.p,{children:["\u8bf7\u6839\u636e\u5982\u4e0b\u6587\u6863\u6765\u914d\u7f6e\u8fde\u63a5LakeSoul\u5143\u6570\u636e\u9700\u8981\u7684PG\u53c2\u6570:\n",(0,n.jsx)(l.a,{href:"/zh-Hans/docs/Usage%20Docs/setup-spark#pass-lakesoul_home-environment-variable-to-your-spark-job",children:"Setup Metadata Database Connection for Spark"})]}),"\n"]}),"\n",(0,n.jsxs)(l.li,{children:["\n",(0,n.jsxs)(l.p,{children:["Add spark conf to ",(0,n.jsx)(l.code,{children:"$SPARK_CONF_DIR/spark-defaults.conf"})]}),"\n",(0,n.jsx)(l.pre,{children:(0,n.jsx)(l.code,{children:"spark.sql.extensions=com.dmetasoul.lakesoul.sql.LakeSoulSparkSessionExtension\n\nspark.sql.catalog.lakesoul=org.apache.spark.sql.lakesoul.catalog.LakeSoulCatalog\n\nspark.sql.defaultCatalog=lakesoul\n\nspark.sql.caseSensitive=false\nspark.sql.legacy.parquet.nanosAsLong=false\n"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(l.h3,{id:"3-\u64cd\u4f5clakesoul-1",children:"3. \u64cd\u4f5cLakeSoul"}),"\n",(0,n.jsx)(l.p,{children:"\u4f7f\u7528Kyuubi beeline\u6765\u8fde\u63a5Spark SQL Engine:"}),"\n",(0,n.jsx)(l.pre,{children:(0,n.jsx)(l.code,{className:"language-bash",children:"$KYUUBI_HOME/bin/beeline -u 'jdbc:hive2://localhost:10009/default;user=admin;?kyuubi.engine.type=SPARK_SQL'\n"})}),"\n",(0,n.jsx)(l.p,{children:"Spark SQL\u8bbf\u95eeLakesoul:"}),"\n",(0,n.jsx)(l.pre,{children:(0,n.jsx)(l.code,{className:"language-SQL",children:"use default;\n\ncreate table if not exists test_lakesoul_table_v2 (id INT, name STRING, score INT, date STRING,region STRING) USING lakesoul PARTITIONED BY (region,date) LOCATION 'hdfs:///lakesoul-test-bucket/default/test_lakesoul_table_v2/';\n\ninsert into test_lakesoul_table_v2 values (1,'AAA', 100, '2023-05-11', 'China');\ninsert into test_lakesoul_table_v2 values (2,'BBB', 100, '2023-05-11', 'China');\ninsert into test_lakesoul_table_v2 values (3,'AAA', 98, '2023-05-10', 'China');\n\nselect * from test_lakesoul_table_v2 limit 1;\n\ndrop table test_lakesoul_table_v2;\n"})}),"\n",(0,n.jsxs)(l.p,{children:["\u53ef\u4ee5\u5c06\u6570\u636e\u5b58\u50a8\u8def\u5f84\u4e2d\u7684",(0,n.jsx)(l.code,{children:"hdfs://"}),"\u66ff\u6362\u4e3a",(0,n.jsx)(l.code,{children:"file://"})," \u3002"]}),"\n",(0,n.jsxs)(l.p,{children:["\u8be6\u7ec6\u7684Spark SQL\u64cd\u4f5cLakesoul\u7684\u5185\u5bb9\u53c2\u9605 : ",(0,n.jsx)(l.a,{href:"/zh-Hans/docs/Usage%20Docs/spark-api-docs#7-operate-lakesoultable-by-spark-sql",children:"Operate LakeSoulTable by Spark SQL"})]})]})}function c(e={}){const{wrapper:l}={...(0,a.a)(),...e.components};return l?(0,n.jsx)(l,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},1151:(e,l,s)=>{s.d(l,{Z:()=>o,a:()=>i});var n=s(7294);const a={},t=n.createContext(a);function i(e){const l=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(l):{...l,...e}}),[l,e])}function o(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(t.Provider,{value:l},e.children)}}}]);